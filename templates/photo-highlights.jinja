<section id="highlights-section" class="faq section theme-bg-primary text-white">
<div class="container">
  <h3 class="section-heading text-center mb-5 text-white">ROCC{{ year }} Photo Highlights</h3>
    <div class="row gx-5 py-lg-5 justify-content-center">

    <style>
        .carouselhighlight-container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .carouselhighlight {
            position: relative;
            width: 100%;
            height: 500px;
            overflow: hidden;
            padding: 20px;
            box-sizing: border-box;
        }

        .carouselhighlight-slide {
            position: absolute;
            top: 40px;
            left: 20px;
            width: calc(100% - 40px);
            height: calc(100% - 40px);
            opacity: 0;
            transition: opacity 1s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            box-sizing: border-box;
        }

        .carouselhighlight-slide.active {
            opacity: 1;
        }

        .carouselhighlight-slide img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .carouselhighlight-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            gap: 15px;
        }

        .carouselhighlight-btn {
            background: white;
            color: black;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 20px;
            transition: background 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .carouselhighlight-btn:hover {
            background: white;
        }

        .carouselhighlight-indicators {
            display: flex;
            gap: 10px;
        }

        .indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: background 0.3s;
        }

        .indicator.active {
            background: #667eea;
        }

        .placeholder-text {
            font-size: 18px;
            color: #666;
            text-align: center;
            padding: 40px;
        }
    </style>


    <div class="carouselhighlight-container mx-auto">
        <div class="carouselhighlight" id="carouselhighlight">
            {% if photo_highlights and photo_highlights|length > 0 %}
            {% for photo in photo_highlights -%}
            <div class="carouselhighlight-slide {% if loop.first %}active{% endif %}">
                <img src="/assets/images/{{ year }}/highlights/{{ photo }}" alt="Photo {{ loop.index }}">
            </div>
            {% endfor %}
            {% else %}
            <div class="carouselhighlight-slide active">
                <div class="placeholder-text">No photos available</div>
            </div>
            {% endif %}
        </div>
        <div class="carouselhighlight-controls">
            <button class="carouselhighlight-btn" id="prevBtn">&#10094;</button>
            <div class="carouselhighlight-indicators" id="indicators"></div>
            <button class="carouselhighlight-btn" id="nextBtn">&#10095;</button>
        </div>
    </div>

    <script>
        const slides = document.querySelectorAll('.carouselhighlight-slide');
        const indicatorsContainer = document.getElementById('indicators');
        const prevBtn = document.getElementById('prevBtn');
        const nextBtn = document.getElementById('nextBtn');

        let currentIndex = 0;
        let autoPlayInterval;

        // Only initialize if there are slides
        if (slides.length > 0) {
            // Create indicators
            slides.forEach((_, index) => {
                const indicator = document.createElement('div');
                indicator.classList.add('indicator');
                if (index === 0) indicator.classList.add('active');
                indicator.addEventListener('click', () => goToSlide(index));
                indicatorsContainer.appendChild(indicator);
            });

            const indicators = document.querySelectorAll('.indicator');

            function updateCarousel() {
                slides.forEach((slide, index) => {
                    slide.classList.remove('active');
                    if (indicators[index]) {
                        indicators[index].classList.remove('active');
                    }
                });

                if (slides[currentIndex]) {
                    slides[currentIndex].classList.add('active');
                    if (indicators[currentIndex]) {
                        indicators[currentIndex].classList.add('active');
                    }
                }
            }

            function nextSlide() {
                if (slides.length > 0) {
                    currentIndex = (currentIndex + 1) % slides.length;
                    updateCarousel();
                }
            }

            function prevSlide() {
                if (slides.length > 0) {
                    currentIndex = (currentIndex - 1 + slides.length) % slides.length;
                    updateCarousel();
                }
            }

            function goToSlide(index) {
                if (slides.length > 0 && index >= 0 && index < slides.length) {
                    currentIndex = index;
                    updateCarousel();
                    resetAutoPlay();
                }
            }

            function startAutoPlay() {
                if (slides.length > 0) {
                    autoPlayInterval = setInterval(nextSlide, 3000);
                }
            }

            function resetAutoPlay() {
                clearInterval(autoPlayInterval);
                startAutoPlay();
            }

            if (prevBtn) {
                prevBtn.addEventListener('click', () => {
                    prevSlide();
                    resetAutoPlay();
                });
            }

            if (nextBtn) {
                nextBtn.addEventListener('click', () => {
                    nextSlide();
                    resetAutoPlay();
                });
            }

            // Start auto-play
            startAutoPlay();
        }
    </script>
    </div>
  </div>
</section>
